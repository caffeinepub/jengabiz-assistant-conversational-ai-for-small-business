{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Add chat history tabs, fix video section, implement real-time market trends, and add autonomous exchange rate table",
  "requirements": [
    {
      "id": "REQ-6",
      "summary": "Refactor ChatPage to implement a tabbed interface with 'Current Chat' and 'History' tabs, moving all messages to History tab while keeping Current Chat for active conversation",
      "acceptanceCriteria": [
        "ChatPage displays two tabs: 'Current Chat' and 'History'",
        "Current Chat tab shows only the active conversation",
        "History tab displays all previous messages with virtualization",
        "Tab switching preserves scroll position and message state",
        "localStorage persistence continues to work across tabs"
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/ChatPage.tsx",
          "operation": "modify",
          "description": "Add tabbed interface with Tabs component from shadcn/ui. Create two tabs: 'Current Chat' for the active conversation input/responses and 'History' for all persisted messages. Maintain existing localStorage persistence logic, virtualization for message rendering in History tab, and debounced message sending. Ensure scroll position is preserved when switching between tabs using refs. Keep the lazy-loaded AnimatedBackground and all existing performance optimizations (memoization, useCallback)."
        }
      ]
    },
    {
      "id": "REQ-7",
      "summary": "Fix VideoLearningPage to resolve display, loading, and functionality issues ensuring video thumbnails, pagination, and dialog player work correctly",
      "acceptanceCriteria": [
        "All video thumbnails display correctly without broken images",
        "Pagination controls work smoothly across all pages",
        "Video dialog player opens and plays content without errors",
        "Lazy loading continues to function for performance",
        "Category filtering works correctly"
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/VideoLearningPage.tsx",
          "operation": "modify",
          "description": "Debug and fix video thumbnail loading by verifying image URLs and adding error handling with fallback images. Ensure pagination state management correctly tracks currentPage across category changes. Fix dialog player by verifying video URL format and iframe embed logic. Maintain existing lazy loading with Intersection Observer and memoized VideoCard components. Add error boundaries and loading states for better UX. Verify category filtering preserves pagination state correctly."
        }
      ]
    },
    {
      "id": "REQ-8",
      "summary": "Implement real-time market trend updates in MarketAnalysisPage by adding periodic data fetching with React Query and displaying last updated timestamp",
      "acceptanceCriteria": [
        "Market trend data automatically refreshes at regular intervals",
        "UI displays a 'Last updated' timestamp",
        "Charts update smoothly without jarring transitions",
        "Manual refresh button continues to work",
        "Real-time updates can be paused/resumed by the user"
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/MarketAnalysisPage.tsx",
          "operation": "modify",
          "description": "Configure React Query to enable automatic refetching with refetchInterval set to 300000ms (5 minutes) for market data queries. Add state to track last update timestamp from query metadata. Display timestamp in UI with relative time formatting (e.g., 'Updated 2 minutes ago'). Add pause/resume toggle button that enables/disables the refetchInterval. Maintain existing manual refresh button functionality. Keep memoized chart data to prevent unnecessary recalculations. Ensure chart transitions are smooth by using recharts animation props."
        },
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Update the market data query hooks to include refetchInterval configuration option. Add lastUpdated timestamp tracking in query metadata. Ensure the query returns both data and timestamp information. Maintain existing query key structure and error handling."
        }
      ]
    },
    {
      "id": "REQ-9",
      "summary": "Add an exchange rate table component to MarketAnalysisPage displaying currency conversion rates with data fetched from backend",
      "acceptanceCriteria": [
        "Exchange rate table displays current rates for major currencies",
        "Table shows base currency (KES) and target currencies with conversion rates",
        "Data is fetched from backend and displayed in a clear tabular format",
        "Table includes a timestamp showing when rates were last updated",
        "Rates are stored persistently in the backend"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/ExchangeRateTable.tsx",
          "operation": "create",
          "description": "Create a memoized exchange rate table component that displays currency pairs and rates in a responsive table format using shadcn/ui Table components. Show base currency (KES) in one column, target currencies (USD, EUR, GBP) in another, and conversion rates with 4 decimal precision. Include a timestamp row showing when rates were last updated using the backend's getLastExchangeRatesUpdateTimestamp method. Add loading skeleton and error states. Use glassmorphism styling to match the app's design language."
        },
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Add useGetExchangeRates hook that fetches exchange rates from backend using actor.getExchangeRates(). Add useGetLastExchangeRatesUpdateTimestamp hook for fetching the last update timestamp. Configure queries with appropriate stale time and cache settings. Return typed ExchangeRate array and timestamp as bigint. Include error handling and loading states."
        },
        {
          "path": "frontend/src/pages/MarketAnalysisPage.tsx",
          "operation": "modify",
          "description": "Import and render the ExchangeRateTable component below the existing market trend charts. Position it in a new section with appropriate spacing and heading ('Exchange Rates'). Ensure it integrates with the page's glassmorphism design and responsive layout. The table will automatically fetch and display data using the hooks from useQueries."
        }
      ]
    }
  ]
}